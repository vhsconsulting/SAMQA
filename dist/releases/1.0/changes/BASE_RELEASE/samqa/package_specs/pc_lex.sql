-- liquibase formatted sql
-- changeset SAMQA:1754374138790 stripComments:false logicalFilePath:BASE_RELEASE\samqa\package_specs\pc_lex.sql runAlways:false runOnChange:false replaceIfExists:true failOnError:true
-- sqlcl_snapshot src/database/samqa/package_specs/pc_lex.sql:null:b7c8a7885ace976b1fda414d1781ca50b46adf16:create

create or replace package samqa.pc_lex is

/* ?????? ? ????????
 13.08.2004 mal + char_only
 13.11.2001 pev ??????? word_count, get_word, ??????? word_suf
 */
/******** ??????? ?????? ?? ??????? **********************/
    function word_count (
        text_in            in varchar2,
        word_delimiters_in in varchar2 default ''
    ) return number;
  /* ?????????? ???-?? ???? ? text_in. word_delimiters - ?????? ????????,
     ??????????? ????????????? ???? */
    function word_suf (
        txt_in             in varchar2,
        suf_in             in varchar2,
        word_delimiters_in in varchar2 default ''
    ) return varchar2;
 /* ???????? ?? txt_in ?????, ?????????? suf_in  */
    function get_word (
        text_in            in varchar2,
        word_no_in         in number,
        word_delimiters_in in varchar2 default ''
    ) return varchar2;
  /* ?????????? ????? ?? text_in ?? ?????? ?????. word_no_in - ????? ????? (c 1);
     word_delimiters - ?????? ????????, ??????????? ????????????? ???? */
    function get_nfld (
        fld_in  in varchar2,
        abon_in in number,
        dop_in  in varchar2 := null
    ) return varchar2;
--   ????????? ???????? ???? fld_in ??? ???????? abon_in
    function let_abon (
        txt_in  in varchar2,
        abon_in in number,
        dop_in  in varchar2 := null
    ) return varchar2;
-- ?????????? ???????????????? ? ?????? txt_in ??? ???????? abon_in
    dummy varchar2(4000);
    cursor c1 (
        who in person.pers_id%type
    ) is
    select
        p.pers_id,
        first_name,
        last_name,
        address,
        decode(title,
               null,
               null,
               rtrim(title, '.')
               || '.')                                             as title,
        decode(middle_name, null, null, middle_name || '.') as middle_name,
        city
        || ', '
        || state_name
        || ' '
        || zip                                              as address2,
        i.deductible,
        i.policy_num,
        i.start_date                                        as start_datei,
        i.end_date,
        i.group_no,
        a.acc_id,
        a.start_date                                        as start_datea,
        a.acc_num,
        a.start_amount,
        a.fee_ini,
        a.fee_setup,
        a.fee_maint,
        a.month_pay
    from
        person    p,
        account   a,
        insure    i,
        us_states s
    where
            p.pers_id = a.pers_id (+)
        and p.pers_id = i.pers_id (+)
        and p.state = s.state_abbr (+)
        and p.pers_id = who;

    c1rec c1%rowtype;
    function char_only (
        str_in in varchar2
    ) return varchar2;
-- remove all non-char from str_in
-- ????????? ??????? ?????? ?? ?????????, ???????? ?? ????????? ?????? (cr+lf)
-- ????:
--    ?????
--    ????? ?????????
--    ??????? ????? ?????????? (0-???)
-- ?????
--    ??????????????? ??????
    function wrap (
        txt_in          in varchar2,
        len_fragment_in in number,
        num_line        in number default 0
    ) return varchar2;

end pc_lex;
/

